package kafka

import java.util.{Date, Properties}
import kafka.producer.KeyedMessage
import kafka.producer.ProducerConfig
import kafka.producer.Producer

/**
  * Created by btw on 2017/11/29.
  */
object SendMessage extends App {

  val props = new Properties()
  props.put("metadata.broker.list","daasinfo1.kafka.dc.puhuifinance.com:6667,daasinfo2.kafka.dc.puhuifinance.com:6667,daasinfo3.kafka.dc.puhuifinance.com:6667,daasinfo4.kafka.dc.puhuifinance.com:6667,daasinfo5.kafka.dc.puhuifinance.com:6667,daasinfo6.kafka.dc.puhuifinance.com:6667,daasinfo7.kafka.dc.puhuifinance.com:6667,daasinfo8.kafka.dc.puhuifinance.com:6667,daasinfo9.kafka.dc.puhuifinance.com:6667,daasinfo10.kafka.dc.puhuifinance.com:6667")  // broker 如果有多个,中间使用逗号分隔
  props.put("serializer.class","kafka.serializer.StringEncoder")
  props.put("request.required.acks","1")
  val config = new ProducerConfig(props)
  val producer = new Producer[String,String](config)
  val runtime = new Date().toString
  val msg = "{\"appName\":\"source-to-kafka\",\"appServerIp\":\"192.168.176.11\",\"appServerPort\":8201,\"syncTaskId\":\"AiQianJinBiEncryptMysqlOnline\",\"syncTaskStartTime\":1508484229029,\"syncTaskSequence\":12920423724,\"sourceType\":\"binlog\",\"dbName\":\"qianjin\",\"tableName\":\"finance_plan_buy_record_detail\",\"msgUuid\":\"mysql-bin.037294123628570\",\"msgSyncStartTime\":1511686624817,\"msgSyncEndTime\":1511686624818,\"dbEffectTime\":1511648854000,\"msgSyncUsedTime\":0,\"msgSize\":1084,\"kafkaTopic\":\"MysqlIqjQianJin\",\"kafkaPartition\":-1,\"kafkaOffset\":-1,\"eventType\":\"DELETE\",\"dbResId\":null,\"mysqlJournalName\":\"mysql-bin.037294\",\"mysqlPosition\":123628570,\"mysqlTimestamp\":1511648854000,\"serverId\":18,\"savedJournalName\":\"mysql-bin.037294\",\"savedOffset\":123628404}\t{\"header\":{\"version\":1,\"logfileName\":\"mysql-bin.037294\",\"logfileOffset\":123628570,\"serverId\":18,\"serverenCode\":\"UTF-8\",\"executeTime\":1511648854000,\"sourceType\":\"MYSQL\",\"schemaName\":\"qianjin\",\"tableName\":\"finance_plan_buy_record_detail\",\"eventLength\":115,\"eventType\":\"DELETE\"},\"rowChange\":{\"rowDatas\":[{\"beforeColumns\":[{\"index\":0,\"isKey\":true,\"isNull\":false,\"mysqlType\":\"bigint(19)\",\"name\":\"id\",\"sqlType\":-5,\"updated\":false,\"value\":\"7022360\"},{\"index\":1,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"bigint(19)\",\"name\":\"plan_id\",\"sqlType\":-5,\"updated\":false,\"value\":\"7683\"},{\"index\":2,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"bigint(19)\",\"name\":\"plan_sub_account_id\",\"sqlType\":-5,\"updated\":false,\"value\":\"3839487\"},{\"index\":3,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"bigint(19)\",\"name\":\"user_id\",\"sqlType\":-5,\"updated\":false,\"value\":\"11663752\"},{\"index\":4,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"varchar(255)\",\"name\":\"user_name\",\"sqlType\":12,\"updated\":false,\"value\":\"程芳\"},{\"index\":5,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"double(16,4)\",\"name\":\"amount\",\"sqlType\":8,\"updated\":false,\"value\":\"100.0\"},{\"index\":6,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"datetime\",\"name\":\"create_time\",\"sqlType\":93,\"updated\":false,\"value\":\"2017-11-26 06:27:34\"},{\"index\":7,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"int(2)\",\"name\":\"gains_process\",\"sqlType\":4,\"updated\":false,\"value\":\"1\"},{\"index\":8,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"datetime\",\"name\":\"update_time\",\"sqlType\":93,\"updated\":false,\"value\":\"2017-11-26 06:27:34\"},{\"index\":9,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"bigint(20)\",\"name\":\"version\",\"sqlType\":-5,\"updated\":false,\"value\":\"0\"},{\"index\":10,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"tinyint(4)\",\"name\":\"buy_origin\",\"sqlType\":-6,\"updated\":false,\"value\":\"1\"},{\"index\":11,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"tinyint(4) unsigned\",\"name\":\"type\",\"sqlType\":-6,\"updated\":false,\"value\":\"6\"},{\"index\":12,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"tinyint(4)\",\"name\":\"is_continued\",\"sqlType\":-6,\"updated\":false,\"value\":\"1\"},{\"index\":13,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"tinyint(4)\",\"name\":\"period_num\",\"sqlType\":-6,\"updated\":false},{\"index\":14,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"datetime\",\"name\":\"continued_time\",\"sqlType\":93,\"updated\":false},{\"index\":15,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"tinyint(4)\",\"name\":\"auto_invest\",\"sqlType\":-6,\"updated\":false,\"value\":\"1\"},{\"index\":16,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"tinyint(4)\",\"name\":\"periods\",\"sqlType\":-6,\"updated\":false,\"value\":\"0\"},{\"index\":17,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"bigint(19)\",\"name\":\"first_buy_record_id\",\"sqlType\":-5,\"updated\":false},{\"index\":18,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"varchar(32)\",\"name\":\"issue\",\"sqlType\":12,\"updated\":false},{\"index\":19,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"datetime\",\"name\":\"extend_continued_time\",\"sqlType\":93,\"updated\":false},{\"index\":20,\"isKey\":false,\"isNull\":true,\"mysqlType\":\"varchar(128)\",\"name\":\"memo\",\"sqlType\":12,\"updated\":false},{\"index\":21,\"isKey\":false,\"isNull\":false,\"mysqlType\":\"\",\"name\":\"syncJsonKey\",\"sqlType\":12,\"updated\":false,\"value\":\"{\\\"appName\\\":\\\"source-to-kafka\\\",\\\"appServerIp\\\":\\\"192.168.176.11\\\",\\\"appServerPort\\\":8201,\\\"syncTaskId\\\":\\\"AiQianJinBiEncryptMysqlOnline\\\",\\\"syncTaskStartTime\\\":1508484229029,\\\"syncTaskSequence\\\":12920423724,\\\"sourceType\\\":\\\"binlog\\\",\\\"dbName\\\":\\\"qianjin\\\",\\\"tableName\\\":\\\"finance_plan_buy_record_detail\\\",\\\"msgUuid\\\":\\\"mysql-bin.037294123628570\\\",\\\"msgSyncStartTime\\\":1511686624817,\\\"msgSyncEndTime\\\":-1,\\\"dbEffectTime\\\":1511648854000,\\\"msgSyncUsedTime\\\":0,\\\"msgSize\\\":1084,\\\"kafkaTopic\\\":\\\"MysqlIqjQianJin\\\",\\\"kafkaPartition\\\":-1,\\\"kafkaOffset\\\":-1,\\\"eventType\\\":\\\"DELETE\\\",\\\"dbResId\\\":null,\\\"mysqlJournalName\\\":\\\"mysql-bin.037294\\\",\\\"mysqlPosition\\\":123628570,\\\"mysqlTimestamp\\\":1511648854000,\\\"serverId\\\":18,\\\"savedJournalName\\\":\\\"mysql-bin.037294\\\",\\\"savedOffset\\\":123628404}\"}]}]}}"
  val topic="cifMonitorWP" //注意topic
  val data = new KeyedMessage[String,String](topic,msg)
  producer.send(data)
  producer.close()


}
